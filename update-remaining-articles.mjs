import { createClient } from '@sanity/client';

const client = createClient({
  projectId: 'fny3jdcg',
  dataset: 'production',
  useCdn: false,
  token: process.env.SANITY_API_TOKEN,
  apiVersion: '2024-01-01',
});

const updates = [
  {
    slug: 'probiotics',
    benefits: [
      "有益菌増加と病原菌抑制で健康的な腸内細菌叢バランスを回復・維持、腸内環境改善を促進",
      "抗生物質関連下痢を60-70%減少、善玉菌補充で消化管健康を保護",
      "過敏性腸症候群（IBS）症状を30-50%軽減、腹痛・膨満感・排便異常を改善",
      "ナチュラルキラー細胞活性40-50%向上、免疫グロブリン産生増加で免疫機能強化",
      "腸管バリア強化と透過性低下で全身炎症減少、腸粘膜保護",
      "セロトニン等の神経伝達物質産生をサポート、腸脳軸を通じて気分・不安・認知機能に影響",
      "ビタミンK2・B群・短鎖脂肪酸等の栄養素合成、栄養吸収と代謝をサポート",
      "特定菌株で血圧2-5mmHg低下、コレステロール5-10%減少等の心血管健康サポート",
      "健康的な血糖調節・インスリン感受性向上をサポート、代謝健康促進",
      "腸内細菌叢多様性と健全性向上、長期的な消化器・全身健康の基盤構築"
    ],
    recommendedDosage: "プロバイオティクスの効果的投与量は菌株・製剤・目的により異なります。一般的な健康維持:10億〜100億CFU/日、消化器サポート:100億〜500億CFU/日、免疫・特定症状:250億〜1,000億CFU/日以上。抗生物質服用中:抗生物質から2-3時間離して200億CFU以上摂取。IBS・消化器症状:特定菌株で100億〜500億CFU/日を8-12週間継続。免疫強化:100億〜200億CFU/日。食事と一緒に摂取で胃酸から保護、生存率向上。冷蔵保存製品は品質維持のため適切に保管。効果には通常2-4週間必要、最大効果には8-12週間継続。菌株の組み合わせが単一菌株より効果的な場合あり。",
    sideEffects: "プロバイオティクスは推奨量で一般的に安全ですが、開始時に軽度の消化器症状（ガス・膨満感・軽い腹部不快感）が数日〜2週間発生、通常自然に解消。免疫低下者・重症患者・中心静脈カテーテル使用者は医師相談必須、まれに菌血症リスク。高用量・急激な導入で一時的な消化不快感、低用量から徐々に増やすと軽減。アレルギー:乳・大豆・グルテン等のアレルゲン含有製品あり、成分表確認必要。ヒスタミン産生菌株はヒスタミン不耐症者に頭痛・皮膚症状引き起こす可能性。SIBO（小腸細菌異常増殖）患者は症状悪化の可能性、専門医指導下で使用。",
    interactions: "免疫抑制剤服用者:プロバイオティクスが免疫を活性化し薬効果に影響、医師相談必須。抗生物質:プロバイオティクス効果減少、2-3時間離して服用、抗生物質終了後も2-4週間継続で腸内細菌叢再構築。抗真菌薬:Saccharomyces boulardii等の酵母ベースプロバイオティクスの効果減少可能性。糖尿病薬:一部のプロバイオティクスが血糖値・インスリン感受性に影響、血糖モニタリング推奨。プレバイオティクス(食物繊維・オリゴ糖等)との併用で相乗効果、プロバイオティクスの増殖・定着促進。発酵食品と併用で腸内細菌叢多様性向上。",
    scientificBackground: "人間の腸内マイクロバイオームには約100兆個の微生物・1000種以上が生息、総重量1-2kg、人間細胞の遺伝物質より多い遺伝情報を保有。代謝・免疫・脳機能・全体的健康に深い影響。プロバイオティクスは病原菌の栄養・付着部位競合、抗菌化合物（バクテリオシン・有機酸・過酸化水素）産生、腸管バリア強化、粘液産生促進、密着結合タンパク質発現増加で作用。免疫調節:樹状細胞・T細胞・B細胞と相互作用、サイトカイン産生調節、分泌型IgA抗体増加、Toll様受容体シグナル伝達調節。腸脳軸:双方向通信経路、プロバイオティクスは神経伝達物質（セロトニン・GABA・ドーパミン）産生、迷走神経シグナル伝達調節、HPA軸影響で気分・不安・認知・ストレス応答に影響。短鎖脂肪酸（酪酸・プロピオン酸・酢酸）産生:腸細胞エネルギー源、抗炎症特性、代謝調節、遺伝子発現影響。菌株特異性が重要:異なる菌株は異なる健康効果、特定症状には特定菌株使用重要。"
  },
  {
    slug: 'vitamin-b-complex',
    benefits: [
      "ATP合成と炭水化物代謝改善でエネルギー産生向上、特にB1・B2・B3・B5が重要",
      "神経伝達物質合成サポートで脳機能・認知・気分を向上、B6・B9・B12が神経健康に重要",
      "赤血球形成と酸素運搬能力向上、B9・B12不足による貧血予防",
      "ホモシステイン代謝で心血管健康サポート、B6・B9・B12が血中ホモシステイン低下",
      "DNA・RNA合成で細胞分裂・組織修復・成長促進、特に妊娠中・成長期に重要",
      "ストレス応答と副腎機能サポート、B5（パントテン酸）がコルチゾール産生に必要",
      "皮膚・髪・爪の健康維持、ビオチン（B7）が特に重要",
      "肝機能と解毒プロセスサポート、B群ビタミンが代謝酵素の補因子として作用",
      "健康的な消化と食欲維持、B1・ナイアシンが消化酵素産生と胃腸機能サポート",
      "免疫細胞産生と機能サポート、B6・B9・B12が免疫応答に重要"
    ],
    recommendedDosage: "ビタミンB群の推奨量は個別ビタミンで異なります。成人の1日推奨量:B1(1.1-1.2mg)、B2(1.1-1.3mg)、B3(14-16mg)、B5(5mg)、B6(1.3-1.7mg)、ビオチン(30mcg)、B9(400mcg、妊婦600-800mcg)、B12(2.4mcg)。B群複合サプリメント:通常各ビタミンの100-200%含有、高ストレス・食事制限・特定薬剤服用・妊娠授乳中・高齢者に有益。活性型(メチル化形態)が吸収・利用に優れる:メチルコバラミン(B12)、メチルフォレート(B9)、P-5-P(B6)。食事と一緒に摂取で吸収向上・胃不快感軽減。水溶性のため過剰分は尿排泄、定期的摂取重要。B3高用量(500mg以上)は紅潮引き起こす可能性、徐々に増量または食事と一緒に。",
    sideEffects: "ビタミンB群は推奨量で安全ですが、高用量で副作用の可能性。B3(ナイアシン):高用量(500mg以上)で紅潮・皮膚発赤・かゆみ・刺痛感、肝機能検査値上昇の可能性。B6:極端な高用量(200mg/日以上を長期)で末梢神経障害、推奨量では安全。B9:高用量でB12欠乏マスク、神経損傷につながる可能性。消化不快感:高用量で吐き気・胃不快感・下痢、食事と一緒に摂取で軽減。尿の色変化:B2で明るい黄色、無害。アレルギー反応:まれに発疹・かゆみ・呼吸困難。妊娠中:B9は重要だが他のB群ビタミン高用量は医師相談。",
    interactions: "特定薬剤がビタミンB群の吸収・代謝・排泄に影響。メトホルミン(糖尿病薬):B12吸収減少、補給または定期的血中濃度測定推奨。プロトンポンプ阻害剤・H2遮断薬:胃酸減少でB12吸収低下、長期使用者は補給考慮。抗けいれん薬:B9・B12レベル低下、補給有益。抗生物質:腸内細菌叢変化でビタミンB合成減少。利尿薬:水溶性B群ビタミンの排泄増加。レボドパ:B6が効果減少、組み合わせには注意・医療監督必要。アルコール:B1・B9・B12の吸収・代謝・貯蔵を損なう、アルコール使用者は補給から利益。",
    scientificBackground: "ビタミンB群は細胞代謝の補酵素として機能、エネルギー産生・DNA合成・神経伝達物質産生に必要。B1(チアミン):炭水化物代謝・神経機能、チアミン二リン酸として補酵素。B2(リボフラビン):FAD・FMNの前駆体、酸化還元反応に関与。B3(ナイアシン):NAD+・NADP+の前駆体、500以上の酵素反応。B5(パントテン酸):コエンザイムA合成、脂肪酸代謝。B6(ピリドキシン):100以上の酵素反応、アミノ酸代謝・神経伝達物質合成。ビオチン:炭水化物・脂肪・タンパク質代謝の補酵素。B9(葉酸):一炭素代謝、DNA合成・メチル化。B12(コバラミン):DNA合成・神経機能・赤血球形成、動物性食品のみ。水溶性で体内貯蔵限定的、定期的摂取必要。MTHFR遺伝子変異者は活性型B9・B12が有益。"
  }
];

async function updateArticles() {
  console.log('Probiotics と Vitamin B Complex を更新します...\n');
  
  for (const update of updates) {
    try {
      console.log(`Processing: ${update.slug}...`);
      
      const existing = await client.fetch(
        `*[_type == "ingredient" && slug.current == $slug][0]{_id}`,
        { slug: update.slug }
      );
      
      if (!existing) {
        console.log(`  ✗ Not found: ${update.slug}`);
        continue;
      }
      
      await client
        .patch(existing._id)
        .set({
          benefits: update.benefits,
          recommendedDosage: update.recommendedDosage,
          sideEffects: update.sideEffects,
          interactions: update.interactions,
          scientificBackground: update.scientificBackground
        })
        .commit();
      
      console.log(`  ✓ Updated: ${update.slug}\n`);
    } catch (error) {
      console.error(`  ✗ Error: ${update.slug}:`, error.message);
    }
  }
  
  console.log('完了しました！');
}

updateArticles();
