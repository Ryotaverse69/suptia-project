# バリューコマース クイックスタートガイド

## 🎉 承認おめでとうございます！

バリューコマースの審査に合格しましたね。これから5つのステップでセットアップを完了させます。

---

## ✅ セットアップチェックリスト（所要時間: 約20分）

### ステップ1: Yahoo!ショッピングと提携（5分）

1. バリューコマース管理画面にログイン
   - https://aff.valuecommerce.ne.jp/

2. Yahoo!ショッピングを検索
   - 「広告」→「広告検索」
   - 検索窓に「Yahoo!ショッピング」

3. 提携申請
   - 「広告作成」ボタンをクリック
   - 提携申請ボタンをクリック

**✅ 結果**: 通常は即時承認（メールで通知）

---

### ステップ2: SIDとPIDを取得（3分）

#### SID（サイトID）の取得

1. バリューコマース管理画面にログイン
2. 画面右上の「サイト管理」をクリック
3. Suptiaの詳細を表示
4. **SID**をコピー（例: `s12345678`）

#### PID（広告ID）の取得

1. 「広告」→「提携状況」をクリック
2. 「Yahoo!ショッピング」を選択
3. 「広告作成」→「MyLink」をクリック
4. 画面上部の**PID**をコピー（例: `p12345678`）

**✅ 結果**: SIDとPIDを取得完了

---

### ステップ3: 環境変数を追加（2分）

#### ローカル環境

`apps/web/.env.local` に以下を追加：

```bash
# バリューコマース（Yahoo!ショッピング アフィリエイト）
VALUE_COMMERCE_SID=s12345678
VALUE_COMMERCE_PID=p12345678
```

**注意**: 実際のSIDとPIDに置き換えてください。

#### Vercel環境（本番）

1. Vercelダッシュボードにログイン
2. Suptiaプロジェクトを選択
3. 「Settings」→「Environment Variables」
4. 以下を追加：

| Name               | Value     |
| ------------------ | --------- |
| VALUE_COMMERCE_SID | s12345678 |
| VALUE_COMMERCE_PID | p12345678 |

5. 「Save」をクリック

**✅ 結果**: 環境変数の設定完了

---

### ステップ4: 既存商品のアフィリエイトリンクを更新（5分）

既にSanityに登録されているYahoo!商品にアフィリエイトリンクを追加します。

```bash
# スクリプトを実行
npx tsx scripts/update-yahoo-affiliate-links.mjs
```

**実行結果例**:

```
🚀 Yahoo!商品のアフィリエイトリンク更新を開始します...

✅ 環境変数チェック完了
   SID: s12345678
   PID: p12345678

📦 Yahoo!商品を取得中...
   取得した商品数: 20件

🔄 アフィリエイトリンクを更新中...

✅ DHC ビタミンC 60日分 (1件のYahoo!価格を更新)
✅ ディアナチュラ マルチビタミン (1件のYahoo!価格を更新)
...

============================================================
📊 更新結果サマリー
============================================================
✅ 成功: 20件
❌ 失敗: 0件
📦 合計: 20件
============================================================

🎉 アフィリエイトリンクの更新が完了しました！
```

**✅ 結果**: 既存商品のアフィリエイトリンク更新完了

---

### ステップ5: 動作確認（5分）

#### 1. ローカル環境で確認

```bash
# 開発サーバーを起動
npm run dev
```

#### 2. 商品詳細ページを開く

```
http://localhost:3000/products/[slug]
```

#### 3. Yahoo!ショッピングのリンクをクリック

- URLが以下の形式で始まることを確認：

  ```
  https://ck.jp.ap.valuecommerce.com/servlet/referral?sid=s12345678&pid=p12345678&vc_url=...
  ```

- リダイレクト後、正しいYahoo!商品ページに遷移することを確認

#### 4. バリューコマース管理画面で確認

1. 管理画面にログイン
2. 「レポート」→「クリックレポート」
3. 数時間後にクリック数が反映されることを確認

**✅ 結果**: アフィリエイトリンクが正常に動作

---

## 🎯 完了！

おめでとうございます！バリューコマースのセットアップが完了しました。

### 次のステップ

1. **Vercelにデプロイ**

   ```bash
   git add .
   git commit -m "feat: バリューコマースのアフィリエイトリンクを実装"
   git push origin master
   ```

2. **Vercelの環境変数を設定**（ステップ3で実施済み）

3. **本番環境で動作確認**
   - https://suptia.com/ で商品リンクをテストクリック

4. **成果レポートを確認**
   - 毎日バリューコマース管理画面でクリック数・成果を確認

---

## 📊 成果確認

### クリック数の確認

- 「レポート」→「クリックレポート」
- 反映時間: 数時間〜24時間

### 成果報酬の確認

- 「レポート」→「成果レポート」
- 報酬率: 商品価格の1〜2%（カテゴリによる）
- Cookie有効期間: 89日間

### 支払い

- 最低支払額: 1,000円
- 支払日: 翌々月15日
- 振込先: 屋号口座（SUPTIA長谷川 亮太）

---

## 🆘 トラブルシューティング

### Q1. アフィリエイトリンクが生成されない

**A**: 環境変数を確認

```bash
# .env.localを確認
cat apps/web/.env.local | grep VALUE_COMMERCE
```

### Q2. リンククリック後に404エラー

**A**: URLの形式を確認

- 正しい形式: `https://ck.jp.ap.valuecommerce.com/servlet/referral?sid=...&pid=...&vc_url=...`

### Q3. クリック数が反映されない

**A**: 以下を確認

- SIDとPIDが正しいか
- リンクのURL形式が正しいか
- クッキーが有効になっているか
- 数時間〜24時間待つ

---

## 📚 関連ドキュメント

- [VALUE_COMMERCE_SETUP_GUIDE.md](VALUE_COMMERCE_SETUP_GUIDE.md) - 詳細セットアップガイド
- [VALUE_COMMERCE_APPLICATION_GUIDE.md](VALUE_COMMERCE_APPLICATION_GUIDE.md) - 申請ガイド
- [VALUE_COMMERCE_BANK_ACCOUNT_GUIDE.md](VALUE_COMMERCE_BANK_ACCOUNT_GUIDE.md) - 屋号口座登録ガイド

---

**最終更新日**: 2025年10月30日
**作成者**: Suptiaプロジェクトチーム
